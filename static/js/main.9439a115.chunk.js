(this.webpackJsonpqrbingo=this.webpackJsonpqrbingo||[]).push([[0],{14:function(e,t,n){e.exports=n.p+"static/media/refresh.8be2e2b2.svg"},16:function(e,t,n){e.exports=n.p+"static/media/camera.2723d63e.svg"},18:function(e,t,n){e.exports=n(38)},2:function(e){e.exports=JSON.parse('{"application":{"name":"qrbingo"},"bingo":{"sheet":{"width":4,"height":4},"slot":{"variations":[{"value":"istj","label":"IS\\nTJ","description":"The Inspector"},{"value":"infj","label":"IN\\nFJ","description":"The Counselor"},{"value":"intj","label":"IN\\nTJ","description":"The Mastermind"},{"value":"enfj","label":"EN\\nFJ","description":"The Giver"},{"value":"istp","label":"IS\\nTP","description":"The Craftsman"},{"value":"esfj","label":"ES\\nFJ","description":"The Provider"},{"value":"infp","label":"IN\\nFP","description":"The Idealist"},{"value":"esfp","label":"ES\\nFP","description":"The Performer"},{"value":"enfp","label":"EN\\nFP","description":"The Champion"},{"value":"estp","label":"ES\\nTP","description":"The Doer"},{"value":"estj","label":"ES\\nTJ","description":"The Supervisor"},{"value":"entj","label":"EN\\nTJ","description":"The Commander"},{"value":"intp","label":"IN\\nTP","description":"The Thinker"},{"value":"isfj","label":"IS\\nFJ","description":"The Nurturer"},{"value":"entp","label":"EN\\nTP","description":"The Visionary"},{"value":"isfp","label":"IS\\nFP","description":"The Composer"}]}}}')},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(12),o=n.n(r),s=(n(23),n(10)),c=(n(24),n(7)),u=n.n(c),l=(n(25),function(e){var t=e.slot;return a.a.createElement("div",{className:u()("sheet-cell",{punched:t.punched,bingo:t.bingo})},t.label.split("\n").map((function(e,t){return a.a.createElement("div",{key:t},e)})))}),h=function(e){var t=e.row;return a.a.createElement("div",{className:"sheet-row"},t.map((function(e,t){return a.a.createElement(l,{key:t,slot:e})})))},v=function(e){var t=e.sheet;return a.a.createElement("div",{className:u()("sheet-wrapper",{bingo:t.isBingo()})},t.slots.map((function(e,t){return a.a.createElement(h,{key:t,row:e})})))},p=n(17),d=n(3),f=n(13),g=n(5),m=n(4),b=n(6),y=n(1),w=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(g.a)(this,Object(m.a)(t).call(this,e))).value=void 0,n.label=void 0,n.description=void 0,n.imageURL=void 0,n.position=void 0,n.punched=void 0,n.bingo=void 0,n.value=e.value,n.label=e.label,n.description=e.description,n.imageURL=e.imageURL,n.position=e.position||{},n.punched=e.punched||!1,n.bingo=e.bingo||!1,n}return Object(b.a)(t,e),t}(y.Model);w.__ns="BingoSlot";var E=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(g.a)(this,Object(m.a)(t).call(this,e,"singleton"))).width=void 0,n.height=void 0,n.slots=void 0,n.length=void 0,n.initialized=void 0,n.width=e.width,n.height=e.height,n.slots=e.slots,n.length=n.width*n.height,n.initialized=e.date||new Date,n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"hit",value:function(e){return this.slots.flat().find((function(t){return t.value===e.value}))}},{key:"punch",value:function(e){var t=this;return this.slots.flat().filter((function(t){return t.value===e.value})).map((function(e){var n=e.position,i=n.x,a=n.y;t.slots[a][i].punched=!0})),this.save()}},{key:"isBingo",value:function(){return 0!==this.getBingo().length}},{key:"getBingo",value:function(){var e=[];return e=(e=(e=e.concat(this.getHorizontalBingo())).concat(this.getVerticalBingo())).concat(this.getDiagonalBingo()),this.markSlotsIfBingo(e),e}},{key:"markSlotsIfBingo",value:function(e){var t=this;e.map((function(e){return t.slots[e.position.y][e.position.x].bingo=!0}))}},{key:"getHorizontalBingo",value:function(){for(var e=0;e<this.height;e++)if(this.slots[e].every((function(e){return e.punched})))return this.slots[e];return[]}},{key:"getVerticalBingo",value:function(){for(var e=this,t=function(t){if(e.slots.every((function(e){return e[t].punched})))return{v:e.slots.map((function(e){return e[t]})).flat()}},n=0;n<this.width;n++){var i=t(n);if("object"===typeof i)return i.v}return[]}},{key:"getDiagonalBingo",value:function(){var e=[];if(this.width!==this.height)return[];var t=Math.min(this.width,this.height),n=this.slots.map((function(e,t){return e[t]}));n.every((function(e){return e.punched}))&&(e=e.concat(n));var i=this.slots.map((function(e,n){return e[t-n-1]}));return i.every((function(e){return e.punched}))&&(e=e.concat(i)),e}}],[{key:"arrayShuffle",value:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e[n],e[t]];e[t]=i[0],e[n]=i[1]}return e}},{key:"getShuffledListWithLength",value:function(e,t){for(var n=[];n.length<t;)n.push.apply(n,Object(p.a)(this.arrayShuffle(e)));return n}},{key:"createSlot",value:function(e,t,n){var i=e.value,a=e.label,r=e.description,o=e.imageURL,s=[t%n,Math.floor(t/n)];return new w({value:i,label:a,description:r,imageURL:o,position:{x:s[0],y:s[1]}})}},{key:"init",value:function(e){var n=this,i=e.sheet,a=i.width,r=i.height,o=Array(r).fill(!0).map((function(){return[]})),s=a*r;return this.getShuffledListWithLength(e.slot.variations,s).map((function(e,t){var i=n.createSlot(e,t,a);return o[i.position.y].push(i)})),new t({width:e.sheet.width,height:e.sheet.height,slots:o})}},{key:"exists",value:function(){return this.find("singleton")}}]),t}(y.Model);E.__ns="BingoSheet",E.schema={width:y.Types.number,height:y.Types.number,slots:y.Types.arrayOf(y.Types.arrayOf(y.Types.reference(w))),initialized:y.Types.date};var T=n(2),S=Object(i.createContext)({bingo:{sheet:E.init(T.bingo)},punch:function(e){},scanning:!1,startScanning:function(){},stopScanning:function(){}}),j=n(14),k=n.n(j),O=(n(35),function(e){var t=e.app,n=e.sheet,i=e.reset;return a.a.createElement("div",{className:"game-menu"},a.a.createElement("h1",null,t.name),a.a.createElement("span",{className:"start-time"},n.initialized.toLocaleString()),a.a.createElement("img",{src:k.a,alt:"Restart Game",onClick:i}))}),I=n(8),N=n.n(I),B=n(15),x=(n(37),n(16)),P=n.n(x),C=n(9),J=n.n(C);var L={audio:!1,video:{width:80,height:80,facingMode:/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent)?{exact:"environment"}:"user"}},M=function(e){var t,n=e.punch,r=Object(i.createRef)(),o=document.createElement("canvas");o.width=80,o.height=80;var s=function(e,i){var a=function(e){var t=e.video,n=e.canvas;if(!n)return null;if(!t)return null;if(!t.srcObject)return null;var i=n.getContext("2d");if(!i)return null;i.drawImage(t,0,0,t.width,t.height);var a=i.getImageData(0,0,t.width,t.height);return J()(a.data,t.width,t.height)}({video:e,canvas:o});a&&(clearInterval(t),e.pause(),i.getTracks().map((function(e){return e.stop()})),n(JSON.parse(a.data)))},c=function(){var e=Object(B.a)(N.a.mark((function e(){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.current){e.next=2;break}return e.abrupt("return");case 2:return r.current.play(),r.current.setAttribute("muted",""),e.next=6,navigator.mediaDevices.getUserMedia(L);case 6:n=e.sent,r.current.srcObject=n,t=setInterval((function(){return s(r.current,n)}),1e3);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"video-capture-container"},a.a.createElement("div",null,a.a.createElement("video",{ref:r,autoPlay:!0,playsInline:!0,width:80,height:80})),a.a.createElement("div",{onClick:c},a.a.createElement("img",{src:P.a,alt:"Star Scanning QR"})))},F=function(e){var t=e.reset;return a.a.createElement(S.Consumer,null,(function(e){var n=e.bingo,i=e.punch;return a.a.createElement("div",{className:"App"},a.a.createElement(O,{app:T.application,sheet:n.sheet,reset:t}),a.a.createElement(v,{sheet:n.sheet}),a.a.createElement(M,{punch:i}))}))},R=function(){var e=Object(i.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],o=E.exists()||E.init(T.bingo).save(),c=Object(i.useState)({sheet:o}),u=Object(s.a)(c,2),l=u[0],h=u[1],v={bingo:l,punch:function(e){var t=l.sheet.hit(e.payload);t&&(alert("Congrats! You found the one!!\n\nThe person with you is ".concat(e.payload.value.toString().toUpperCase(),"!")),h({sheet:l.sheet.punch(t)}))},scanning:n,startScanning:function(){return r(!0)},stopScanning:function(){return r(!1)}};return a.a.createElement(S.Provider,{value:v},a.a.createElement(F,{reset:function(){window.confirm("Are you sure to delete current progress and start new game?")&&h({sheet:E.init(T.bingo).save()})}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[18,1,2]]]);
//# sourceMappingURL=main.9439a115.chunk.js.map