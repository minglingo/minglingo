(this.webpackJsonpqrbingo=this.webpackJsonpqrbingo||[]).push([[0],[,,,function(e){e.exports=JSON.parse('{"application":{"name":"qrbingo (\u4eee)"},"bingo":{"sheet":{"width":4,"height":4},"slot":{"variations":[{"value":"istj","label":"IS\\nTJ","description":"The Inspector"},{"value":"infj","label":"IN\\nFJ","description":"The Counselor"},{"value":"intj","label":"IN\\nTJ","description":"The Mastermind"},{"value":"enfj","label":"EN\\nFJ","description":"The Giver"},{"value":"istp","label":"IS\\nTP","description":"The Craftsman"},{"value":"esfj","label":"ES\\nFJ","description":"The Provider"},{"value":"infp","label":"IN\\nFP","description":"The Idealist"},{"value":"esfp","label":"ES\\nFP","description":"The Performer"},{"value":"enfp","label":"EN\\nFP","description":"The Champion"},{"value":"estp","label":"ES\\nTP","description":"The Doer"},{"value":"estj","label":"ES\\nTJ","description":"The Supervisor"},{"value":"entj","label":"EN\\nTJ","description":"The Commander"},{"value":"intp","label":"IN\\nTP","description":"The Thinker"},{"value":"isfj","label":"IS\\nFJ","description":"The Nurturer"},{"value":"entp","label":"EN\\nTP","description":"The Visionary"},{"value":"isfp","label":"IS\\nFP","description":"The Composer"}]}}}')},,,,,,,,function(e,t,n){e.exports=n.p+"static/media/camera.2723d63e.svg"},,function(e,t,n){e.exports=n(23)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(8),o=n.n(a),u=(n(18),n(1)),l=(n(19),n(4)),c=n.n(l),s=(n(20),function(e){var t=e.slot;return i.a.createElement("div",{className:c()("sheet-cell",{punched:t.punched,bingo:t.bingo})},t.label.split("\n").map((function(e,t){return i.a.createElement("div",{key:t},e)})))}),h=function(e){var t=e.row;return i.a.createElement("div",{className:"sheet-row"},t.map((function(e,t){return i.a.createElement(s,{key:t,slot:e})})))},f=function(e){var t=e.sheet;return i.a.createElement("div",{className:c()("sheet-wrapper",{bingo:t.isBingo()})},t.slots.map((function(e,t){return i.a.createElement(h,{key:t,row:e})})))},p=n(12),v=n(2),g=n(9),d=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0},o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];Object(v.a)(this,e),this.value=t,this.label=n,this.description=r,this.imageURL=i,this.position=a,this.punched=o,this.bingo=u},m=function(){function e(t,n,r){Object(v.a)(this,e),this.width=t,this.height=n,this.slots=r,this.length=void 0,this.length=t*n}return Object(g.a)(e,[{key:"hit",value:function(e){return this.slots.flat().find((function(t){return t.value===e.value}))}},{key:"punch",value:function(e){var t=this;return this.slots.flat().filter((function(t){return t.value===e.value})).map((function(e){var n=e.position,r=n.x,i=n.y;t.slots[i][r].punched=!0})),this}},{key:"isBingo",value:function(){return 0!==this.getBingo().length}},{key:"getBingo",value:function(){var e=[];return e=(e=(e=e.concat(this.getHorizontalBingo())).concat(this.getVerticalBingo())).concat(this.getDiagonalBingo()),this.markSlotsIfBingo(e),e}},{key:"markSlotsIfBingo",value:function(e){var t=this;e.map((function(e){return t.slots[e.position.y][e.position.x].bingo=!0}))}},{key:"getHorizontalBingo",value:function(){for(var e=0;e<this.height;e++)if(this.slots[e].every((function(e){return e.punched})))return this.slots[e];return[]}},{key:"getVerticalBingo",value:function(){for(var e=this,t=function(t){if(e.slots.every((function(e){return e[t].punched})))return{v:e.slots.map((function(e){return e[t]})).flat()}},n=0;n<this.width;n++){var r=t(n);if("object"===typeof r)return r.v}return[]}},{key:"getDiagonalBingo",value:function(){var e=[];if(this.width!==this.height)return[];var t=Math.min(this.width,this.height),n=this.slots.map((function(e,t){return e[t]}));n.every((function(e){return e.punched}))&&(e=e.concat(n));var r=this.slots.map((function(e,n){return e[t-n-1]}));return r.every((function(e){return e.punched}))&&(e=e.concat(r)),e}}],[{key:"arrayShuffle",value:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}return e}},{key:"getShuffledListWithLength",value:function(e,t){for(var n=[];n.length<t;)n.push.apply(n,Object(p.a)(this.arrayShuffle(e)));return n}},{key:"createSlot",value:function(e,t,n){var r=e.value,i=e.label,a=e.description,o=e.imageURL,u=[t%n,Math.floor(t/n)];return new d(r,i,a,o,{x:u[0],y:u[1]})}},{key:"create",value:function(t){var n=this,r=t.sheet,i=r.width,a=r.height,o=Array(a).fill(!0).map((function(){return[]})),u=i*a;return this.getShuffledListWithLength(t.slot.variations,u).map((function(e,t){var r=n.createSlot(e,t,i);return o[r.position.y].push(r)})),new e(t.sheet.width,t.sheet.height,o)}}]),e}(),b=n(3),y=Object(r.createContext)({bingo:{sheet:m.create(b.bingo)},punch:function(e){}}),E=n(5),w=n.n(E),k=n(10),T=n(11),S=n.n(T),j=(n(22),n(6)),N=n.n(j);function I(e){return new Promise((function(t){var n=new Image;n.src=e,n.onload=function(){var e=document.createElement("canvas"),r=[n.width,n.height];e.width=r[0],e.height=r[1];var i=e.getContext("2d");if(i){i.drawImage(n,0,0);var a=N()(i.getImageData(0,0,n.width,n.height).data,n.width,n.height);t(a)}}}))}var O=function(e){e.pushLog;var t=e.punch,n=Object(r.useRef)(null),a=Object(r.useState)(""),o=Object(u.a)(a,2),l=o[0],c=o[1];return i.a.createElement("div",{className:"capture-trigger-wrapper"},i.a.createElement("div",{className:"capture-result-container"},l?i.a.createElement("img",{src:l,alt:"Captured"}):null),i.a.createElement("div",{className:"capture-trigger-container",onClick:function(){return n.current&&n.current.click()}},i.a.createElement("img",{src:S.a,alt:"Capture QR code!"})),i.a.createElement("input",{ref:n,type:"file",accept:"image/*",capture:!0,onChange:function(e){var n=e.target;if(!n.files||!n.files.length)return c("");var r=n.files[0],i=new FileReader;i.onload=Object(k.a)(w.a.mark((function e(){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(i.result),e.next=3,I(i.result);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:r=JSON.parse(n.data),t(r);case 8:case"end":return e.stop()}}),e)}))),i.readAsDataURL(r)}}))},B=function(e){var t=e.log;return i.a.createElement("li",null,JSON.stringify(t))},J=function(e){var t=e.pushLog;return i.a.createElement(y.Consumer,null,(function(e){var n=e.bingo,r=e.punch;return i.a.createElement("div",{className:"App"},i.a.createElement(f,{sheet:n.sheet}),i.a.createElement(O,{pushLog:t,punch:r}))}))},x=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)({sheet:m.create(b.bingo)}),l=Object(u.a)(o,2),c=l[0],s=l[1];return i.a.createElement(y.Provider,{value:{bingo:c,punch:function(e){var t=c.sheet.hit(e.payload);t&&s({sheet:c.sheet.punch(t)})}}},i.a.createElement(J,{pushLog:function(e){return a(n.concat(e))}}),i.a.createElement("div",null,i.a.createElement("ul",null,n.reverse().map((function(e){return i.a.createElement(B,{key:e.timestamp,log:e})})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[13,1,2]]]);
//# sourceMappingURL=main.022c49c4.chunk.js.map